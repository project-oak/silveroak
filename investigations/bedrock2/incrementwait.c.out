     = "#include <stdint.h>
#include <memory.h>

// LITTLE-ENDIAN memory access is REQUIRED
// the following two functions are required to work around -fstrict-aliasing
static inline uintptr_t _br2_load(uintptr_t a, size_t sz) {
  uintptr_t r = 0;
  memcpy(&r, (void*)a, sz);
  return r;
}

static inline void _br2_store(uintptr_t a, uintptr_t v, size_t sz) {
  memcpy((void*)a, &v, sz);
}


uintptr_t put_wait_get(uintptr_t input) {
  uintptr_t status, out;
  REG32_SET((uintptr_t)4100ULL, input);
  status = (uintptr_t)0ULL;
  while (((status)&(((uintptr_t)1ULL)<<((uintptr_t)2ULL)))==((uintptr_t)0ULL)) {
    status = REG32_GET((uintptr_t)4096ULL);
  }
  out = REG32_GET((uintptr_t)4100ULL);
  return out;
}

"%string
     : string
